---
layout: single 
title: PingCAP 前景分析 vs 达梦,Cockroach (一)
categories: [investment]
---

最近在知乎上看到一个问题，大致问的是「PingCAP 裁员，国产数据库是不是要凉凉了」？PingCAP 的 TiDB 是我心目中的最牛的国产数据库，居然有人怀疑最牛的国产数据库和它所在的行业要凉凉了，我觉得这个想法很大胆，按捺不住写下这篇文章给出一个我的回答。 

首先我想说我的看法是国产数据库是绝对不会凉凉的（我相信提这个问题的人也是这个看法，这个问题有一点**恶意**提问 + 寻衅滋事的嫌疑，建议法办 :) ），因为我们国家的贸易保护主义不会允许这种事情发生，党政军国企一定会有国产数据库的蛋糕吃，怎么都不会全给饿死了。

那么，PingCAP 裁员了，是不是说明它就快凉凉了呢？本系列文章就来对 PingCAP 作一个分析，尝试回答一下这个问题。

本文是本系列文章的第一篇，主要内容是一篇「粗糙」的市场分析。


我们知道，一个公司有好发展的前提就是跑在一个好赛道，本文做市场分析的重要目标就是让我们对数据库这个赛道有一个理性的认知，了解它的好坏程度到底是怎么样的。

为此，我们必须弄明白以下几个问题：
1. 数据库这块蛋糕有多大？（市场规模）
2. 数据库这块蛋糕有没有快快变大？（增量市场的增长情况）
3. 数据库这块蛋糕的切法有没有变化？（存量市场的竞争情况）


![]({{ site.url }}{{ site.baseurl }}/assets/images/2023-04-08-pingcap-dameng/img.png)

首先回答一下第一个问题：蛋糕有多大？我们从上面这幅图可以看到，国内数据库的市场规模大概在 500 亿，占全球数据库市场规模的 10% 左右，换句话说，全球数据库的市场规模大概在 5000 亿（近 1000 亿美元）。从这里我们可以看出来，数据库企业只收割国内韭菜是赚不了大钱的，赚大钱还得收割老欧老美！

为了对这块蛋糕的大小理解得更**清醒**一点，我在这里对比一下我国最高科技行业——白酒行业（其龙头企业以酱香科技闻名）的**国内**市场规模大概在 6000 亿人民币（10x 于国内数据库规模），以及距离各位读者最近的手机行业的**全球**市场规模大概在 10000 亿美元（10x 于全球数据库规模）。

读到这里大家可能会有所灰心？怎么市场规模差白酒行业和手机行业这么多？我劝大家一句，人家这俩行业都是关系国计民生的行业，我们就别跟人家比了，这个大小的蛋糕也够我们吃了。

其次我回答一下第二个问题，同时也来振奋一下大家的信心，相信大家在上面图中也看到了，未来几年数据库市场规模的增速还是比较乐观的，年复合增长率（CAGR）大概在 20% 多，说明数据库这份蛋糕在快快变大。

再对比一下，白酒行业年复合增长率大约 1%，手机行业近几年不增反降，呈现「负增长」局面，形势一片大好。读到这里大家心里应该会好受一点，我们的涨势比它们都好，未来差距会不断缩小。


![]({{ site.url }}{{ site.baseurl }}/assets/images/2023-04-08-pingcap-dameng/img_1.png)


有人可能会问，为什么未来几年数据库行业的市场规模增长率这么高？我的看法是全球数字经济远没有到天花板，当前看似的成熟市场（如美国，中国）数字化越来越深入，数据量也越来越大，对数据库的需求也与日俱增。同时新兴市场（如拉丁美洲）发展还尚处于早期，也处于一个良性的发展态势。

最后，回答一下第三个问题，数据库这块蛋糕的切法在切切实实的发生改变，新进入的玩家获得了更多的市场机会。在**全球**市场上，随着云计算和分布式的发展，云数据库会吃下一部分非云数据库的蛋糕，分布式数据库会吃下一部分集中式数据库的蛋糕。在**国内**市场上，除了云数据库和分布式数据库带来的切法变化，还有另外一个重大政策因素产生影响。由于中美合作又对抗的背景，政府要求国内党政军等行业必须从美国的数据库切换到使用国产数据库，也就是所谓的数据库信创。换句话说，国内市场的蛋糕，国产数据库会从国外数据库那里夺下信创这部分。


![2021 年中国数据库市场行业分布(销售额)]({{ site.url }}{{ site.baseurl }}/assets/images/2023-04-08-pingcap-dameng/img_2.png)

上文我们说过，国内数据库的市场规模大概在数百亿，那信创数据库的市场规模大概在多少呢？东吴证券测算：
> 2021 年金融、政府、运营商、能源、教育、交通、医疗等重要行业占数据库市场份额高达 68%。根据中国信通院数据，我们测算 2027 年中国数据库市场规模有望达到 900 亿 元，对应潜在国产化数据库市场约为 520 亿元。

综上，我们可以粗略认为信创数据库市场规模占据国内总的数据库市场规模的 70%，是绝对的大头。我们注意到，上图中互联网仅占 14%，这个比较小的规模，相对于互联网纯纯的数字化场景，简直可以说是白嫖了。不过也不奇怪，互联网公司很多都用开源产品，尤其是 MySQL，不花钱，又稳定，自己雇佣的技术人员有能力维护数据库，这个行业自然对数据库的市场规模的贡献就比较小了。

回答了上面三个问题，我们对数据库整个的一个市场有了一个宏观的认识，那么赶紧再聊会 PingCAP 吧。上面聊到的市场，和 PingCAP 的关系又是怎么样的呢？

PingCAP 的主营业务是 TiDB 产品（或者说围绕 TiDB 的数据平台产品）。TiDB 是一个开源的 HTAP 关系数据库。「开源」，「HTAP」，「关系」这三个定语都非常重要，关系到 TiDB 的一个市场规模天花板。

首先说一下**开源**。开源决定了有没有潜力成为全球第一的数据库。或者这句话再加个限制，开源决定了有没有潜力成为「出生在中国」，生长于全球的全球第一数据库。为什么这么说，其实说白了就是，你一个中国数据库，如果不开源，老欧老美敢用？虽然说开源了也不一定敢用，例如 TiTok 对美国裸奔了也要面临被强制收购，不过不开源基本上是不敢用的。 所以一个中国的数据库，如果要想收割全球市场，有野心做全球第一的数据库，第一步就是要开源！在开源这一点上，TiDB 完胜国内的竞争对手达梦，达梦的上限也就只能靠着国资背景收割一下国内的韭菜企业了。不过潜力归潜力，最终还是要看能不能拿到市场份额，如果 TiDB 在全球市场拿不到市场份额，那肯定也是远远不如达梦这种闷声大发财活得滋润的。

其次说一下 **HTAP**。我们都知道 HTAP = TP + AP。理论上 HTAP 数据库的市场规模就是 TP 和 AP 数据库市场规模的总和，这个大饼足够的大！TiDB 选择 HTAP 相当于走广度优先的路线（大而全），CockroachDB 专注于 TP 相当于走深度优先的路线（小而精），各有优劣。哪种做法更好，我经验不足，给不出一个答案，就让时间来回答吧。（这里补充一下，实际上 HTAP 总是面临权衡取舍，大部分 HTAP 的实现都是以 TP 作为一等公民，牺牲一些 AP 能力，因此 HTAP 数据库必然不能全吃下 AP 的市场规模。）

最后说一下**关系**，在全球范围内，关系数据库的市场规模占数据库总的市场规模大概在 80%，在国内，关系数据库的市场规模栈数据库总的市场规模大概在 90%，因此选择了关系数据库这个赛道，意味着数据库这块蛋糕的绝大部分都可以放在盘子上了。

那放在盘子上的蛋糕，PingCAP 有没有能力吃得下呢？

在全球市场，PingCAP 已经通过开源拿到了全球市场的门票，进入了竞争残酷的全球市场：CR6(前六家）的市场份额在 80% 左右，这是一个寡头垄断的市场，对新进入的玩家压力非常大。不过由于云和分布式的技术转型，一些老玩家转型不够迅速，给新进入的玩家带来了「赶英超美」的机会，PingCAP 会受益于此。话虽如此，目前的现状 CockroachDB 大约只占有 0.11% 的市场份额，TiDB 应该比它还会稍微低一点，只能说一句任重而道远。

在国内市场，上文已经说了，大头在信创市场。遗憾的是，TiDB 貌似目前没有进入信创产品名录（可能是由于 VIE 架构？但是我确实了解到有 VIE 架构的公司在这个名录里面，矛盾了），因此信创这块蛋糕暂时吃不了。（信创产品名录是保密的，确认一个数据库产品是否在名录里面，我的经验是在 Google 搜索「信创工委会 + 数据库名」或者搜索该数据库有没有某个行业信息技术创新的资格证书，如果能找到东西的话，就认为在这个名录里面）。这么看来，TiDB 目前在国内暂时的市场主要就是那 14% 的互联网市场，看起来比较小，不过我认为随着中国人口红利的下降，劳动成本力的上升，互联网公司也会改变观念做法，选择去买厂家规模效应后的低成本的服务，而不是自己雇佣员工去「瞎搞」。因此，我的结论是，这部分的市场规模未来会更大一些，不过，我对这个增大的速度持谨慎态度。

本文是本系列的第一部分，主要分析了 PingCAP 面向的国内外数据库市场情况，让读者先建立一个宏观的认识，算是热热身。接下来的几篇文章，我会将 PingCAP 和它国内的友商达梦，以及国外的友商 Cockroach Labs 做对比，包括但不限于对比公司的产品，商业模式，财务情况，估值，上市等等方面，欢迎大家关注我的公众号「黄金架构师」或者知乎跟进阅读。此外，您的点赞和喜欢是对我最大的鼓励和最大的写作加速，非常感谢！

另外说一下，这个系列不是给 TiDB 写软文，证据就是我也时常黑 TiDB，例如我也曾经写过吹 CockroachDB 踩 TiDB 的文章，感兴趣的读者也可以看看我写过的这篇文章：[《为什么 CockroachDB 的跨地域性能远超同行》](https://zhuanlan.zhihu.com/p/600284531)。